function [y, T, residual, g1] = dynamic_2(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(6, 1);
  T(10)=exp(y(3));
  T(11)=exp(y(30));
  T(12)=exp(y(29));
  T(13)=T(10)*T(11)/T(12);
  T(14)=exp(y(40));
  T(15)=T(14)^(1-y(31));
  T(16)=(params(8)/params(7))^params(1);
  T(17)=(T(15)/exp(y(41))^(1-y(32))*(y(31)/y(32))^y(32)*((1-y(31))/(1-y(32)))^(1-y(32)))^(1-params(1));
  T(18)=(params(9)/params(7))^params(1);
  T(19)=(T(15)/exp(y(42))^(1-y(33))*(y(31)/y(33))^y(33)*((1-y(31))/(1-y(33)))^(1-y(33)))^(1-params(1));
  T(20)=(params(10)/params(7))^params(1);
  T(21)=(T(15)/exp(y(43))^(1-y(34))*(y(31)/y(34))^y(34)*((1-y(31))/(1-y(34)))^(1-y(34)))^(1-params(1));
  T(22)=(params(11)/params(7))^params(1);
  T(23)=(T(15)/exp(y(44))^(1-y(35))*(y(31)/y(35))^y(35)*((1-y(31))/(1-y(35)))^(1-y(35)))^(1-params(1));
  T(24)=(params(12)/params(7))^params(1);
  T(25)=(T(15)/exp(y(45))^(1-y(36))*(y(31)/y(36))^y(36)*((1-y(31))/(1-y(36)))^(1-y(36)))^(1-params(1));
  T(26)=(params(13)/params(7))^params(1);
  T(27)=(T(15)/exp(y(46))^(1-y(37))*(y(31)/y(37))^y(37)*((1-y(31))/(1-y(37)))^(1-y(37)))^(1-params(1));
  T(28)=(params(14)/params(7))^params(1);
  T(29)=(T(15)/exp(y(47))^(1-y(38))*(y(31)/y(38))^y(38)*((1-y(31))/(1-y(38)))^(1-y(38)))^(1-params(1));
  T(30)=(params(15)/params(7))^params(1);
  T(31)=(T(15)/exp(y(48))^(1-y(39))*(y(31)/y(39))^y(39)*((1-y(31))/(1-y(39)))^(1-y(39)))^(1-params(1));
  T(32)=1+T(13)^((1-params(1))*(y(31)-y(32)))*T(16)*T(17)+T(13)^((1-params(1))*(y(31)-y(33)))*T(18)*T(19)+T(13)^((1-params(1))*(y(31)-y(34)))*T(20)*T(21)+T(13)^((1-params(1))*(y(31)-y(35)))*T(22)*T(23)+T(13)^((1-params(1))*(y(31)-y(36)))*T(24)*T(25)+T(13)^((1-params(1))*(y(31)-y(37)))*T(26)*T(27)+T(13)^((1-params(1))*(y(31)-y(38)))*T(28)*T(29)+T(13)^((1-params(1))*(y(31)-y(39)))*T(30)*T(31);
  T(33)=exp(y(3)*T(11)/T(12));
  T(34)=exp(y(25));
  T(35)=exp(y(28));
  T(36)=T(34)/T(35);
  T(37)=y(31)*(1-T(36)*(1-1/T(32)));
  T(38)=y(31)+T(17)*T(16)*y(32)*T(33)^((1-params(1))*(y(31)-y(32)))+T(19)*T(18)*y(33)*T(33)^((1-params(1))*(y(31)-y(33)))+T(21)*T(20)*y(34)*T(33)^((1-params(1))*(y(31)-y(34)))+T(23)*T(22)*y(35)*T(33)^((1-params(1))*(y(31)-y(35)))+T(25)*T(24)*y(36)*T(33)^((1-params(1))*(y(31)-y(36)))+T(27)*T(26)*y(37)*T(33)^((1-params(1))*(y(31)-y(37)))+T(29)*T(28)*y(38)*T(33)^((1-params(1))*(y(31)-y(38)))+T(31)*T(30)*y(39)*T(33)^((1-params(1))*(y(31)-y(39)))-y(31)*T(32);
  T(39)=T(38)/T(32);
  T(40)=T(36)*T(39);
  residual(1)=(T(11))-(T(37)/(y(31)+T(40)));
  T(41)=exp(y(27));
  residual(2)=(y(26))-(T(41)*(1+params(5))*(1+params(4))-T(10)*(1-params(3)));
  T(42)=exp(y(49));
  T(43)=T(41)*exp(y(54));
  T(44)=exp(y(53));
  T(45)=T(43)/T(44);
  T(46)=T(34)*params(2)*(1+y(55)*T(45)^(y(55)-1)-params(3));
  residual(3)=(T(42))-(T(46));
  T(47)=(1-y(31))*(1-T(36)*(1-1/T(32)));
  residual(4)=(T(12))-(T(47)/(1-y(31)-T(40)));
  T(48)=(T(10)*T(11))^y(31);
  T(49)=(T(12)*T(14))^(1-y(31));
  residual(5)=(T(34)/T(32))-(T(48)*T(49)-y(26));
  T(50)=(1-y(31))*T(15)*T(10)^y(31);
  T(51)=(T(11)/T(12))^y(31);
  T(52)=T(50)*T(51);
  residual(6)=(T(35))-(T(52)/(1-y(31)-T(40)));
  T(53)=(1-y(31)-T(40))*(1-y(31)-T(40));
  T(54)=getPowerDeriv(T(13),(1-params(1))*(y(31)-y(32)),1);
  T(55)=getPowerDeriv(T(13),(1-params(1))*(y(31)-y(33)),1);
  T(56)=getPowerDeriv(T(13),(1-params(1))*(y(31)-y(34)),1);
  T(57)=getPowerDeriv(T(13),(1-params(1))*(y(31)-y(35)),1);
  T(58)=getPowerDeriv(T(13),(1-params(1))*(y(31)-y(36)),1);
  T(59)=getPowerDeriv(T(13),(1-params(1))*(y(31)-y(37)),1);
  T(60)=getPowerDeriv(T(13),(1-params(1))*(y(31)-y(38)),1);
  T(61)=getPowerDeriv(T(13),(1-params(1))*(y(31)-y(39)),1);
  T(62)=T(17)*T(16)*T(13)*T(54)+T(19)*T(18)*T(13)*T(55)+T(21)*T(20)*T(13)*T(56)+T(23)*T(22)*T(13)*T(57)+T(25)*T(24)*T(13)*T(58)+T(27)*T(26)*T(13)*T(59)+T(29)*T(28)*T(13)*T(60)+T(31)*T(30)*T(13)*T(61);
  T(63)=getPowerDeriv(T(33),(1-params(1))*(y(31)-y(32)),1);
  T(64)=getPowerDeriv(T(33),(1-params(1))*(y(31)-y(33)),1);
  T(65)=getPowerDeriv(T(33),(1-params(1))*(y(31)-y(34)),1);
  T(66)=getPowerDeriv(T(33),(1-params(1))*(y(31)-y(35)),1);
  T(67)=getPowerDeriv(T(33),(1-params(1))*(y(31)-y(36)),1);
  T(68)=getPowerDeriv(T(33),(1-params(1))*(y(31)-y(37)),1);
  T(69)=getPowerDeriv(T(33),(1-params(1))*(y(31)-y(38)),1);
  T(70)=getPowerDeriv(T(33),(1-params(1))*(y(31)-y(39)),1);
  T(71)=T(36)*(T(32)*(T(17)*T(16)*y(32)*T(33)*T(11)/T(12)*T(63)+T(19)*T(18)*y(33)*T(33)*T(11)/T(12)*T(64)+T(21)*T(20)*y(34)*T(33)*T(11)/T(12)*T(65)+T(23)*T(22)*y(35)*T(33)*T(11)/T(12)*T(66)+T(25)*T(24)*y(36)*T(33)*T(11)/T(12)*T(67)+T(27)*T(26)*y(37)*T(33)*T(11)/T(12)*T(68)+T(29)*T(28)*y(38)*T(33)*T(11)/T(12)*T(69)+T(31)*T(30)*y(39)*T(33)*T(11)/T(12)*T(70)-y(31)*T(62))-T(38)*T(62))/(T(32)*T(32));
  T(72)=(-(T(34)*T(62)))/(T(32)*T(32))-T(49)*T(10)*T(11)*getPowerDeriv(T(10)*T(11),y(31),1);
  T(73)=getPowerDeriv(T(45),y(55)-1,1);
  T(74)=(-(T(10)*T(11)*T(12)))/(T(12)*T(12));
  T(75)=T(17)*T(16)*T(54)*T(74)+T(19)*T(18)*T(55)*T(74)+T(21)*T(20)*T(56)*T(74)+T(23)*T(22)*T(57)*T(74)+T(25)*T(24)*T(58)*T(74)+T(27)*T(26)*T(59)*T(74)+T(29)*T(28)*T(60)*T(74)+T(31)*T(30)*T(61)*T(74);
  T(76)=T(33)*(-(T(12)*y(3)*T(11)))/(T(12)*T(12));
  T(77)=T(36)*(T(32)*(T(17)*T(16)*y(32)*T(63)*T(76)+T(19)*T(18)*y(33)*T(64)*T(76)+T(21)*T(20)*y(34)*T(65)*T(76)+T(23)*T(22)*y(35)*T(66)*T(76)+T(25)*T(24)*y(36)*T(67)*T(76)+T(27)*T(26)*y(37)*T(68)*T(76)+T(29)*T(28)*y(38)*T(69)*T(76)+T(31)*T(30)*y(39)*T(70)*T(76)-y(31)*T(75))-T(38)*T(75))/(T(32)*T(32));
  T(78)=getPowerDeriv(T(11)/T(12),y(31),1);
  T(79)=y(3)*T(11)/T(12)*T(33);
  T(80)=T(36)*(T(32)*(T(17)*T(16)*y(32)*T(63)*T(79)+T(19)*T(18)*y(33)*T(64)*T(79)+T(21)*T(20)*y(34)*T(65)*T(79)+T(23)*T(22)*y(35)*T(66)*T(79)+T(25)*T(24)*y(36)*T(67)*T(79)+T(27)*T(26)*y(37)*T(68)*T(79)+T(29)*T(28)*y(38)*T(69)*T(79)+T(31)*T(30)*y(39)*T(70)*T(79)-y(31)*T(62))-T(38)*T(62))/(T(32)*T(32));
if nargout > 3
    g1_v = NaN(28, 1);
g1_v(1)=(-(((y(31)+T(40))*y(31)*(-(T(36)*(-((-T(62))/(T(32)*T(32))))))-T(37)*T(71))/((y(31)+T(40))*(y(31)+T(40)))));
g1_v(2)=T(10)*(1-params(3));
g1_v(3)=(-(((1-y(31)-T(40))*(1-y(31))*(-(T(36)*(-((-T(62))/(T(32)*T(32))))))-T(47)*(-T(71)))/T(53)));
g1_v(4)=T(72);
g1_v(5)=(-(((1-y(31)-T(40))*T(51)*(1-y(31))*T(15)*T(10)*getPowerDeriv(T(10),y(31),1)-T(52)*(-T(71)))/T(53)));
g1_v(6)=(-(((y(31)+T(40))*y(31)*(-((1-1/T(32))*(-(T(34)*T(35)))/(T(35)*T(35))))-T(37)*T(39)*(-(T(34)*T(35)))/(T(35)*T(35)))/((y(31)+T(40))*(y(31)+T(40)))));
g1_v(7)=(-(((1-y(31)-T(40))*(1-y(31))*(-((1-1/T(32))*(-(T(34)*T(35)))/(T(35)*T(35))))-T(47)*(-(T(39)*(-(T(34)*T(35)))/(T(35)*T(35)))))/T(53)));
g1_v(8)=T(35)-(-(T(52)*(-(T(39)*(-(T(34)*T(35)))/(T(35)*T(35))))))/T(53);
g1_v(9)=1;
g1_v(10)=1;
g1_v(11)=(-(T(41)*(1+params(5))*(1+params(4))));
g1_v(12)=(-(T(34)*params(2)*y(55)*T(45)*T(73)));
g1_v(13)=(-(((y(31)+T(40))*y(31)*(-(T(36)*(1-1/T(32))))-T(37)*T(40))/((y(31)+T(40))*(y(31)+T(40)))));
g1_v(14)=(-T(46));
g1_v(15)=(-(((1-y(31)-T(40))*(1-y(31))*(-(T(36)*(1-1/T(32))))-T(47)*(-T(40)))/T(53)));
g1_v(16)=T(34)/T(32);
g1_v(17)=(-((-(T(52)*(-T(40))))/T(53)));
g1_v(18)=(-(((y(31)+T(40))*y(31)*(-(T(36)*(-((-T(75))/(T(32)*T(32))))))-T(37)*T(77))/((y(31)+T(40))*(y(31)+T(40)))));
g1_v(19)=T(12)-((1-y(31)-T(40))*(1-y(31))*(-(T(36)*(-((-T(75))/(T(32)*T(32))))))-T(47)*(-T(77)))/T(53);
g1_v(20)=(-(T(34)*T(75)))/(T(32)*T(32))-T(48)*T(12)*T(14)*getPowerDeriv(T(12)*T(14),1-y(31),1);
g1_v(21)=(-(((1-y(31)-T(40))*T(50)*(-(T(11)*T(12)))/(T(12)*T(12))*T(78)-T(52)*(-T(77)))/T(53)));
g1_v(22)=T(11)-((y(31)+T(40))*y(31)*(-(T(36)*(-((-T(62))/(T(32)*T(32))))))-T(37)*T(80))/((y(31)+T(40))*(y(31)+T(40)));
g1_v(23)=(-(((1-y(31)-T(40))*(1-y(31))*(-(T(36)*(-((-T(62))/(T(32)*T(32))))))-T(47)*(-T(80)))/T(53)));
g1_v(24)=T(72);
g1_v(25)=(-(((1-y(31)-T(40))*T(50)*T(11)/T(12)*T(78)-T(52)*(-T(80)))/T(53)));
g1_v(26)=T(42);
g1_v(27)=(-(T(34)*params(2)*y(55)*T(73)*(-(T(43)*T(44)))/(T(44)*T(44))));
g1_v(28)=(-(T(34)*params(2)*y(55)*T(45)*T(73)));
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 6, 18);
end
end
