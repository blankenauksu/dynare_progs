function [y, T, residual, g1] = dynamic_2(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(4, 1);
  y(25)=y(26)*(1+params(6))*(1+params(5))-y(3)*(1-params(3));
  T(1)=(y(29)/(y(24)/(y(1)*params(2))-1+params(3)))^(1/(1-y(29)));
  T(2)=exp(y(38));
  T(3)=T(2)^(1-y(29));
  T(4)=(((1-y(29))*(1-y(29)))^(1-y(29)))^(1-params(1));
  T(5)=(params(9)/params(8))^params(1);
  T(6)=(y(29)/y(30))^y(30);
  T(7)=((1-y(29))*(1-y(30)))^(1-y(30));
  T(8)=(T(3)/exp(y(39))^(1-y(30))*T(6)*T(7))^(1-params(1));
  T(9)=(params(10)/params(8))^params(1);
  T(10)=(y(29)/y(31))^y(31);
  T(11)=((1-y(29))*(1-y(31)))^(1-y(31));
  T(12)=(T(3)/exp(y(40))^(1-y(31))*T(10)*T(11))^(1-params(1));
  T(13)=(params(11)/params(8))^params(1);
  T(14)=(y(29)/y(32))^y(32);
  T(15)=((1-y(29))*(1-y(32)))^(1-y(32));
  T(16)=(T(3)/exp(y(41))^(1-y(32))*T(14)*T(15))^(1-params(1));
  T(17)=(params(12)/params(8))^params(1);
  T(18)=(y(29)/y(33))^y(33);
  T(19)=((1-y(29))*(1-y(33)))^(1-y(33));
  T(20)=(T(3)/exp(y(42))^(1-y(33))*T(18)*T(19))^(1-params(1));
  T(21)=(params(13)/params(8))^params(1);
  T(22)=(y(29)/y(34))^y(34);
  T(23)=((1-y(29))*(1-y(34)))^(1-y(34));
  T(24)=(T(3)/exp(y(43))^(1-y(34))*T(22)*T(23))^(1-params(1));
  T(25)=(params(14)/params(8))^params(1);
  T(26)=(y(29)/y(35))^y(35);
  T(27)=((1-y(29))*(1-y(35)))^(1-y(35));
  T(28)=(T(3)/exp(y(44))^(1-y(35))*T(26)*T(27))^(1-params(1));
  T(29)=(params(15)/params(8))^params(1);
  T(30)=(y(29)/y(36))^y(36);
  T(31)=((1-y(29))*(1-y(36)))^(1-y(36));
  T(32)=(T(3)/exp(y(45))^(1-y(36))*T(30)*T(31))^(1-params(1));
  T(33)=(params(16)/params(8))^params(1);
  T(34)=(y(29)/y(37))^y(37);
  T(35)=((1-y(29))*(1-y(37)))^(1-y(37));
  T(36)=(T(3)/exp(y(46))^(1-y(37))*T(34)*T(35))^(1-params(1));
  T(37)=y(38)^(1-y(29));
  T(38)=(T(7)*T(6)*T(37)/y(39)^(1-y(30)))^(1-params(1));
  T(39)=(T(11)*T(10)*T(37)/y(40)^(1-y(31)))^(1-params(1));
  T(40)=(T(15)*T(14)*T(37)/y(41)^(1-y(32)))^(1-params(1));
  T(41)=(T(19)*T(18)*T(37)/y(42)^(1-y(33)))^(1-params(1));
  T(42)=(T(23)*T(22)*T(37)/y(43)^(1-y(34)))^(1-params(1));
  T(43)=(T(27)*T(26)*T(37)/y(44)^(1-y(35)))^(1-params(1));
  T(44)=(T(31)*T(30)*T(37)/y(45)^(1-y(36)))^(1-params(1));
  T(45)=(T(35)*T(34)*T(37)/y(46)^(1-y(37)))^(1-params(1));
  T(46)=(1-y(29))*T(3)*y(26)^y(29);
  T(47)=(T(1)*y(28)/y(3)/y(28))^y(29);
  T(48)=T(46)*T(47);
  T(49)=(T(1))^((1-params(1))*(y(29)-y(30)));
  T(50)=(T(1))^((1-params(1))*(y(29)-y(31)));
  T(51)=(T(1))^((1-params(1))*(y(29)-y(32)));
  T(52)=(T(1))^((1-params(1))*(y(29)-y(33)));
  T(53)=(T(1))^((1-params(1))*(y(29)-y(34)));
  T(54)=(T(1))^((1-params(1))*(y(29)-y(35)));
  T(55)=(T(1))^((1-params(1))*(y(29)-y(36)));
  T(56)=(T(1))^((1-params(1))*(y(29)-y(37)));
  T(57)=T(4)+T(8)*T(5)*T(49)+T(12)*T(9)*T(50)+T(16)*T(13)*T(51)+T(20)*T(17)*T(52)+T(24)*T(21)*T(53)+T(28)*T(25)*T(54)+T(32)*T(29)*T(55)+T(36)*T(33)*T(56);
  T(58)=y(29)*T(4)+T(38)*T(5)*y(30)*T(49)+T(39)*T(9)*y(31)*T(50)+T(40)*T(13)*y(32)*T(51)+T(41)*T(17)*y(33)*T(52)+T(42)*T(21)*y(34)*T(53)+T(43)*T(25)*y(35)*T(54)+T(44)*T(29)*y(36)*T(55)+T(45)*T(33)*y(37)*T(56)-y(29)*T(57);
  T(59)=T(58)/T(57);
  T(60)=y(24)/y(27)*T(59);
  residual(1)=(y(27))-(T(48)/(1-y(29)-T(60)));
  residual(2)=(T(1)*y(28)/y(3))-(y(29)*(1-y(24)/y(27)*(1-1/T(57)))/(y(29)+T(60)));
  residual(3)=(y(28))-((1-y(29))*(1-y(24)/y(27)*(1-1/T(57)))/(1-y(29)+T(60)));
  T(61)=(y(28)*T(2))^(1-y(29));
  T(62)=(T(1)*y(28)/y(3)*y(26))^y(29);
  residual(4)=(y(24)/T(57))-(T(61)*T(62)-y(25));
  T(63)=getPowerDeriv(T(1)*y(28)/y(3)*y(26),y(29),1);
  T(64)=getPowerDeriv(T(1)*y(28)/y(3)/y(28),y(29),1);
  T(65)=getPowerDeriv(y(29)/(y(24)/(y(1)*params(2))-1+params(3)),1/(1-y(29)),1)*(-(y(29)*1/(y(1)*params(2))))/((y(24)/(y(1)*params(2))-1+params(3))*(y(24)/(y(1)*params(2))-1+params(3)));
  T(66)=getPowerDeriv(T(1),(1-params(1))*(y(29)-y(30)),1)*T(65);
  T(67)=getPowerDeriv(T(1),(1-params(1))*(y(29)-y(31)),1)*T(65);
  T(68)=getPowerDeriv(T(1),(1-params(1))*(y(29)-y(32)),1)*T(65);
  T(69)=getPowerDeriv(T(1),(1-params(1))*(y(29)-y(33)),1)*T(65);
  T(70)=getPowerDeriv(T(1),(1-params(1))*(y(29)-y(34)),1)*T(65);
  T(71)=getPowerDeriv(T(1),(1-params(1))*(y(29)-y(35)),1)*T(65);
  T(72)=getPowerDeriv(T(1),(1-params(1))*(y(29)-y(36)),1)*T(65);
  T(73)=getPowerDeriv(T(1),(1-params(1))*(y(29)-y(37)),1)*T(65);
  T(74)=T(8)*T(5)*T(66)+T(12)*T(9)*T(67)+T(16)*T(13)*T(68)+T(20)*T(17)*T(69)+T(24)*T(21)*T(70)+T(28)*T(25)*T(71)+T(32)*T(29)*T(72)+T(36)*T(33)*T(73);
  T(75)=(-((1-1/T(57))*1/y(27)+y(24)/y(27)*(-((-T(74))/(T(57)*T(57))))));
  T(76)=T(59)*1/y(27)+y(24)/y(27)*(T(57)*(T(38)*T(5)*y(30)*T(66)+T(39)*T(9)*y(31)*T(67)+T(40)*T(13)*y(32)*T(68)+T(41)*T(17)*y(33)*T(69)+T(42)*T(21)*y(34)*T(70)+T(43)*T(25)*y(35)*T(71)+T(44)*T(29)*y(36)*T(72)+T(45)*T(33)*y(37)*T(73)-y(29)*T(74))-T(58)*T(74))/(T(57)*T(57));
if nargout > 3
    g1_v = NaN(13, 1);
g1_v(1)=(-(T(46)*T(64)*(y(28)*T(1)/y(3)-T(1)*y(28)/y(3))/(y(28)*y(28))/(1-y(29)-T(60))));
g1_v(2)=T(1)/y(3);
g1_v(3)=1;
g1_v(4)=(-(T(62)*T(2)*getPowerDeriv(y(28)*T(2),1-y(29),1)+T(61)*T(63)*y(26)*T(1)/y(3)));
g1_v(5)=1-(-(T(48)*(-(T(59)*(-y(24))/(y(27)*y(27))))))/((1-y(29)-T(60))*(1-y(29)-T(60)));
g1_v(6)=(-(((y(29)+T(60))*y(29)*(-((1-1/T(57))*(-y(24))/(y(27)*y(27))))-y(29)*(1-y(24)/y(27)*(1-1/T(57)))*T(59)*(-y(24))/(y(27)*y(27)))/((y(29)+T(60))*(y(29)+T(60)))));
g1_v(7)=(-(((1-y(29)+T(60))*(1-y(29))*(-((1-1/T(57))*(-y(24))/(y(27)*y(27))))-(1-y(29))*(1-y(24)/y(27)*(1-1/T(57)))*T(59)*(-y(24))/(y(27)*y(27)))/((1-y(29)+T(60))*(1-y(29)+T(60)))));
g1_v(8)=(-(((1-y(29)-T(60))*T(46)*T(64)*y(28)*T(65)/y(3)/y(28)-T(48)*(-T(76)))/((1-y(29)-T(60))*(1-y(29)-T(60)))));
g1_v(9)=y(28)*T(65)/y(3)-((y(29)+T(60))*y(29)*T(75)-y(29)*(1-y(24)/y(27)*(1-1/T(57)))*T(76))/((y(29)+T(60))*(y(29)+T(60)));
g1_v(10)=(-(((1-y(29)+T(60))*(1-y(29))*T(75)-(1-y(29))*(1-y(24)/y(27)*(1-1/T(57)))*T(76))/((1-y(29)+T(60))*(1-y(29)+T(60)))));
g1_v(11)=(T(57)-y(24)*T(74))/(T(57)*T(57))-T(61)*T(63)*y(26)*y(28)*T(65)/y(3);
g1_v(12)=(-(T(47)*(1-y(29))*T(3)*getPowerDeriv(y(26),y(29),1)/(1-y(29)-T(60))));
g1_v(13)=(-(T(61)*T(1)*y(28)/y(3)*T(63)-(1+params(6))*(1+params(5))));
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 4, 4);
end
end
