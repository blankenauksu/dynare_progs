function [y, T, residual, g1] = dynamic_2(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(6, 1);
  T(4)=exp(y(22));
  T(5)=T(4)^(1-y(19));
  T(6)=(((1-y(19))*(1-y(19)))^(1-y(19)))^(1-params(1));
  T(7)=(y(3)*y(18)/y(17))^((1-params(1))*(y(19)-y(20)));
  T(8)=(params(8)/params(7))^params(1);
  T(9)=(T(5)/exp(y(23))^(1-y(20))*(y(19)/y(20))^y(20)*((1-y(19))*(1-y(20)))^(1-y(20)))^(1-params(1));
  T(10)=(y(3)*y(18)/y(17))^((1-params(1))*(y(19)-y(21)));
  T(11)=(params(9)/params(7))^params(1);
  T(12)=(T(5)/exp(y(24))^(1-y(21))*(y(19)/y(21))^y(21)*((1-y(19))*(1-y(21)))^(1-y(21)))^(1-params(1));
  T(13)=T(6)+T(7)*T(8)*T(9)+T(10)*T(11)*T(12);
  T(14)=y(19)*(1-y(13)/y(16)*(1-1/T(13)));
  T(15)=y(19)*T(6)+T(9)*T(8)*y(20)*T(7)+T(12)*T(11)*y(21)*T(10)-y(19)*T(13);
  T(16)=T(15)/T(13);
  T(17)=y(13)/y(16)*T(16);
  residual(1)=(y(18))-(T(14)/(y(19)+T(17)));
  residual(2)=(y(14))-(y(15)*(1+params(5))*(1+params(4))-y(3)*(1-params(3)));
  T(18)=1+y(31)*(y(15)*y(30)/y(29))^(y(31)-1)-params(3);
  residual(3)=(y(25))-(y(13)*params(2)*T(18));
  T(19)=(1-y(19))*(1-y(13)/y(16)*(1-1/T(13)));
  residual(4)=(y(17))-(T(19)/(1-y(19)-T(17)));
  T(20)=(y(18)*y(15))^y(19);
  T(21)=(y(17)*T(4))^(1-y(19));
  residual(5)=(y(13)/T(13))-(T(20)*T(21)-y(14));
  T(22)=(1-y(19))*T(5)*y(15)^y(19);
  T(23)=(y(18)/y(17))^y(19);
  T(24)=T(22)*T(23);
  residual(6)=(y(16))-(T(24)/(1-y(19)-T(17)));
  T(25)=(1-y(19)-T(17))*(1-y(19)-T(17));
  T(26)=getPowerDeriv(y(3)*y(18)/y(17),(1-params(1))*(y(19)-y(20)),1);
  T(27)=y(18)/y(17)*T(26);
  T(28)=getPowerDeriv(y(3)*y(18)/y(17),(1-params(1))*(y(19)-y(21)),1);
  T(29)=y(18)/y(17)*T(28);
  T(30)=y(13)/y(16)*(T(13)*(T(9)*T(8)*y(20)*T(27)+T(12)*T(11)*y(21)*T(29)-y(19)*(T(9)*T(8)*T(27)+T(12)*T(11)*T(29)))-T(15)*(T(9)*T(8)*T(27)+T(12)*T(11)*T(29)))/(T(13)*T(13));
  T(31)=getPowerDeriv(y(15)*y(30)/y(29),y(31)-1,1);
  T(32)=getPowerDeriv(y(18)*y(15),y(19),1);
  T(33)=T(9)*T(8)*T(26)*(-(y(3)*y(18)))/(y(17)*y(17))+T(12)*T(11)*T(28)*(-(y(3)*y(18)))/(y(17)*y(17));
  T(34)=y(13)/y(16)*(T(13)*(T(9)*T(8)*y(20)*T(26)*(-(y(3)*y(18)))/(y(17)*y(17))+T(12)*T(11)*y(21)*T(28)*(-(y(3)*y(18)))/(y(17)*y(17))-y(19)*T(33))-T(15)*T(33))/(T(13)*T(13));
  T(35)=getPowerDeriv(y(18)/y(17),y(19),1);
  T(36)=T(9)*T(8)*T(26)*y(3)/y(17)+T(12)*T(11)*T(28)*y(3)/y(17);
  T(37)=y(13)/y(16)*(T(13)*(T(9)*T(8)*y(20)*T(26)*y(3)/y(17)+T(12)*T(11)*y(21)*T(28)*y(3)/y(17)-y(19)*T(36))-T(15)*T(36))/(T(13)*T(13));
if nargout > 3
    g1_v = NaN(30, 1);
g1_v(1)=(-(((y(19)+T(17))*y(19)*(-(y(13)/y(16)*(-((-(T(9)*T(8)*T(27)+T(12)*T(11)*T(29)))/(T(13)*T(13))))))-T(14)*T(30))/((y(19)+T(17))*(y(19)+T(17)))));
g1_v(2)=1-params(3);
g1_v(3)=(-(((1-y(19)-T(17))*(1-y(19))*(-(y(13)/y(16)*(-((-(T(9)*T(8)*T(27)+T(12)*T(11)*T(29)))/(T(13)*T(13))))))-T(19)*(-T(30)))/T(25)));
g1_v(4)=(-(y(13)*(T(9)*T(8)*T(27)+T(12)*T(11)*T(29))))/(T(13)*T(13));
g1_v(5)=(-((-(T(24)*(-T(30))))/T(25)));
g1_v(6)=(-(((y(19)+T(17))*y(19)*(-((1-1/T(13))*(-y(13))/(y(16)*y(16))))-T(14)*T(16)*(-y(13))/(y(16)*y(16)))/((y(19)+T(17))*(y(19)+T(17)))));
g1_v(7)=(-(((1-y(19)-T(17))*(1-y(19))*(-((1-1/T(13))*(-y(13))/(y(16)*y(16))))-T(19)*(-(T(16)*(-y(13))/(y(16)*y(16)))))/T(25)));
g1_v(8)=1-(-(T(24)*(-(T(16)*(-y(13))/(y(16)*y(16))))))/T(25);
g1_v(9)=1;
g1_v(10)=1;
g1_v(11)=(-((1+params(5))*(1+params(4))));
g1_v(12)=(-(y(13)*params(2)*y(31)*y(30)/y(29)*T(31)));
g1_v(13)=(-(T(21)*y(18)*T(32)));
g1_v(14)=(-(T(23)*(1-y(19))*T(5)*getPowerDeriv(y(15),y(19),1)/(1-y(19)-T(17))));
g1_v(15)=(-(((y(19)+T(17))*y(19)*(-(y(13)/y(16)*(-((-T(33))/(T(13)*T(13))))))-T(14)*T(34))/((y(19)+T(17))*(y(19)+T(17)))));
g1_v(16)=1-((1-y(19)-T(17))*(1-y(19))*(-(y(13)/y(16)*(-((-T(33))/(T(13)*T(13))))))-T(19)*(-T(34)))/T(25);
g1_v(17)=(-(y(13)*T(33)))/(T(13)*T(13))-T(20)*T(4)*getPowerDeriv(y(17)*T(4),1-y(19),1);
g1_v(18)=(-(((1-y(19)-T(17))*T(22)*(-y(18))/(y(17)*y(17))*T(35)-T(24)*(-T(34)))/T(25)));
g1_v(19)=1-((y(19)+T(17))*y(19)*(-(y(13)/y(16)*(-((-T(36))/(T(13)*T(13))))))-T(14)*T(37))/((y(19)+T(17))*(y(19)+T(17)));
g1_v(20)=(-(((1-y(19)-T(17))*(1-y(19))*(-(y(13)/y(16)*(-((-T(36))/(T(13)*T(13))))))-T(19)*(-T(37)))/T(25)));
g1_v(21)=(-(y(13)*T(36)))/(T(13)*T(13))-T(21)*y(15)*T(32);
g1_v(22)=(-(((1-y(19)-T(17))*T(22)*T(35)*1/y(17)-T(24)*(-T(37)))/T(25)));
g1_v(23)=(-(((y(19)+T(17))*y(19)*(-((1-1/T(13))*1/y(16)))-T(14)*T(16)*1/y(16))/((y(19)+T(17))*(y(19)+T(17)))));
g1_v(24)=(-(params(2)*T(18)));
g1_v(25)=(-(((1-y(19)-T(17))*(1-y(19))*(-((1-1/T(13))*1/y(16)))-T(19)*(-(T(16)*1/y(16))))/T(25)));
g1_v(26)=1/T(13);
g1_v(27)=(-((-(T(24)*(-(T(16)*1/y(16)))))/T(25)));
g1_v(28)=(-(y(13)*params(2)*y(31)*T(31)*(-(y(15)*y(30)))/(y(29)*y(29))));
g1_v(29)=(-(y(13)*params(2)*y(31)*T(31)*y(15)/y(29)));
g1_v(30)=1;
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 6, 18);
end
end
